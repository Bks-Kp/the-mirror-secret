<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Chapter 6 â€” The Final Reflection</title>
  <link rel="stylesheet" href="style.css">
</head>
<body style="background: url('images/chapter6-bg.jpg') center/cover fixed no-repeat;">
  <div class="page-wrap">
    <div class="panel" role="main">
      <h1 class="h-title">Chapter 6 â€” The Final Reflection</h1>

      <div id="story" class="typewriter"></div>

      <div class="choice-row">
        <button class="choice" onclick="(function(){ saveProgress('chapter6'); finalize('touched'); })()">Touch the Mirror</button>
        <button class="choice" onclick="(function(){ saveProgress('chapter6'); finalize('broken'); })()">Break the Mirror</button>
      </div>

      <div id="final-msg" class="small" style="margin-top:14px"></div>
    </div>
  </div>

  <script src="script.js"></script>
  <script>
    // âœ¨ Final Chapter Storyline
    const txt6 = `
The mansion falls silent.

Every mirror flickers with fragments of the choices sheâ€™s made.
Heart. Silence. Memory. Light. Bharath.

Each reflection merges into one â€” her true self, standing at the final mirror.
Through the shimmering surface, she sees him: Bharath.
He smiles softly, waiting â€” not as a ghost, but as a promise.

The mirror hums with two paths.
To touch it is to cross into light... to break it is to let go forever.

Kalpana takes a breath.
Her heart whispers: what will you choose?
`;

    // âŒ› Typewriter animation
    function typeWriter(text, id, speed, callback) {
      let i = 0;
      const el = document.getElementById(id);
      function typing() {
        if (i < text.length) {
          el.innerHTML += text.charAt(i);
          i++;
          setTimeout(typing, speed);
        } else if (callback) callback();
      }
      typing();
    }

    typeWriter(txt6, 'story', 28, () => saveProgress('chapter6'));

    // ðŸ’¡ Save progress (placeholder)
    function saveProgress(chapter) {
      localStorage.setItem("lastChapter", chapter);
    }

    // ðŸ”€ Branch to correct ending
    function finalize(choice) {
      const msg = document.getElementById("final-msg");

      if (choice === 'touched') {
        msg.innerHTML = "The mirror glows softly... her reflection smiles back. The curse breaks.";
        setTimeout(() => window.location.href = "ending.html", 3500);
      } 
      else if (choice === 'broken') {
        msg.innerHTML = "Glass shatters like a scream â€” silence swallows the light.";
        setTimeout(() => window.location.href = "ending2.html", 3500);
      }
    }
  </script>
</body>
</html>
